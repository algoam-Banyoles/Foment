{"version":3,"file":"main.js","sources":["src/js/install.js","src/main.js","src/js/sw-register.js"],"sourcesContent":["let deferredPrompt = null;\n\nexport function setupInstallPrompt() {\n  const installButton = document.querySelector('[data-install]');\n  if (!installButton) return;\n\n  const hideButton = () => {\n    installButton.hidden = true;\n    installButton.disabled = false;\n  };\n\n  const showButton = () => {\n    installButton.hidden = false;\n    installButton.disabled = false;\n  };\n\n  const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;\n  if (isStandalone) {\n    hideButton();\n  } else {\n    installButton.hidden = true;\n  }\n\n  window.addEventListener('beforeinstallprompt', (event) => {\n    event.preventDefault();\n    deferredPrompt = event;\n    showButton();\n  });\n\n  installButton.addEventListener('click', async () => {\n    if (!deferredPrompt) return;\n\n    installButton.disabled = true;\n\n    try {\n      deferredPrompt.prompt();\n      await deferredPrompt.userChoice;\n    } finally {\n      deferredPrompt = null;\n      hideButton();\n    }\n  });\n\n  window.addEventListener('appinstalled', () => {\n    deferredPrompt = null;\n    hideButton();\n  });\n}\n","import { setupInstallPrompt } from './js/install.js';\nimport { setupServiceWorker } from './js/sw-register.js';\n\nsetupInstallPrompt();\nsetupServiceWorker();\n","const SERVICE_WORKER_URL = './service-worker.js';\n\nexport function setupServiceWorker() {\n  if (!('serviceWorker' in navigator)) return;\n\n  window.addEventListener('load', async () => {\n    try {\n      const registration = await navigator.serviceWorker.register(SERVICE_WORKER_URL);\n      if (registration.waiting) {\n        console.info('Service worker preparat per actualitzar.');\n      } else {\n        console.info('Service worker registrat correctament.');\n      }\n    } catch (error) {\n      console.error('No s\\'ha pogut registrar el service worker:', error);\n    }\n  });\n}\n"],"names":["deferredPrompt","installButton","document","querySelector","hideButton","hidden","disabled","window","matchMedia","matches","navigator","standalone","addEventListener","event","preventDefault","async","prompt","userChoice","setupInstallPrompt","serviceWorker","register","waiting","console","info","error"],"mappings":"AAAA,IAAIA,EAAiB,MAEd,WACL,MAAMC,EAAgBC,SAASC,cAAc,kBAC7C,IAAKF,EAAe,OAEpB,MAAMG,EAAa,KACjBH,EAAcI,QAAS,EACvBJ,EAAcK,UAAW,GAQNC,OAAOC,WAAW,8BAA8BC,SAAWF,OAAOG,UAAUC,WAE/FP,IAEAH,EAAcI,QAAS,EAGzBE,OAAOK,iBAAiB,sBAAwBC,IAC9CA,EAAMC,iBACNd,EAAiBa,EAbjBZ,EAAcI,QAAS,EACvBJ,EAAcK,UAAW,IAgB3BL,EAAcW,iBAAiB,QAASG,UACtC,GAAKf,EAAL,CAEAC,EAAcK,UAAW,EAEzB,IACEN,EAAegB,eACThB,EAAeiB,UACvB,CAAC,QACCjB,EAAiB,KACjBI,GACF,CAVqB,IAavBG,OAAOK,iBAAiB,eAAgB,KACtCZ,EAAiB,KACjBI,KAEJ,CC5CAc,GCAQ,kBAAmBR,WAEzBH,OAAOK,iBAAiB,OAAQG,UAC9B,WAC6BL,UAAUS,cAAcC,SAP9B,wBAQJC,QACfC,QAAQC,KAAK,4CAEbD,QAAQC,KAAK,yCAEjB,CAAE,MAAOC,GACPF,QAAQE,MAAM,6CAA+CA,EAC/D"}